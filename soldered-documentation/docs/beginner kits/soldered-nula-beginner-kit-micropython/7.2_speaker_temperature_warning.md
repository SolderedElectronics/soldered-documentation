---
slug: /soldered-nula-beginner-kit-micropython/speaker-temp-warning
title: 7.2. Speaker Temperature Warning
id: speaker-temp-warning
hide_title: true
---

<SectionTitle title="7.2. Speaker Temperature Warning" backgroundImage="/img/arduino_bg.jpg" />

Sometimes when working with sensors, instead of displaying data or sending it to the internet you might want some kind of audio feedback instead. This example demonstrates how you can play a warning sound when the temperature reading exceeds a certain threshold.

**At the end of this example you will learn:**
- How to combine temperature sensor with a speaker
- How to trigger a warning sound based on temperature reading

---

**Parts required:**
- **Soldered NULA Mini board**
- **Breadboard**
- **SHTC3 sensor**
- **1 x Speaker**
- **1 x Qwiic cable**
- **Jumper wires**

<CenteredImage src="/img/under_construction.png" alt="Under construction" width="400px" />

- Use a Qwiic cable to connect the SHTC3 sensor to NULA Mini
- Connect the positive terminal of the speaker to pin 5 on the board (or any PWM capable pin)
- Connect the negative terminal of the speaker to the GND on the board

## Code Example


Import needed libraries

```python
from machine import Pin, PWM, I2C
from SHTC3 import SHTC3
import time
```

Initialize I2C connection with `SHTC3` sensor and create `PWM` object for speaker on pin 5. Turn the speaker off initially.

```python
i2c = I2C(0, scl=Pin(7), sda=Pin(6))
shtc3 = SHTC3(i2c)

SPEAKER_PIN = 5
speaker = PWM(Pin(SPEAKER_PIN))
speaker.duty_u16(0)     
```

Declare warning note wariable with frequency set in `Hz`. Define variables for minimum delay between alarm warning sounds and temperature threshold to trigger the alarm.

```python
NOTE_C6 = 1047

ALARM_COOLDOWN_S = 10 * 1000 # 10 seconds

THRESHOLD_C = 28
```

Function responsible for playing a tone at given frequency and duration.

```python
def tone(freq, duration_MS, loudness = 30000):
    speaker.freq(freq)             # Set frequency (tone)
    speaker.duty_u16(loudness)     # Loudness (default set to 50% duty cycle)
    time.sleep_ms(duration_MS)     # Play for duration
    speaker.duty_u16(0)            # Turn off speaker
```

Function to play 3 simultaneous warning tones.

```python
def play_warning():
    for _ in range(3):             # Repeat the beep pattern three times
        tone(NOTE_C6, 500)         # Play NOTE_C6 for 500 milliseconds
        time.sleep_ms(120)         # Short pause between beeps
```

Define variables for alarm playback state.

```python
last_alarm_ms = -10_000
alarm_armed = False
```

In the main loop sample the values from sensor and check if temperature reading is higher than set threshold. If the reading exceeds the set threshold, arm the alarm and play the warning sound.

```python
while True:
    # Sample the values from SHTC3 sensors before reading them
    shtc3.sample()
    
    # Read the temp and humidity values and store them
    temperature = shtc3.readTemperature()
    humidity = shtc3.readHumidity()
    
    # Print info
    print("Temperature: {:.2f} Â°C | Humidity: {:.1f} %".format(temperature, humidity))
    
    # Save previous alarm state
    prev_state = alarm_armed
    # Update alarm_armed state
    alarm_armed = (temperature >= THRESHOLD_C)
    
    # Store current time
    now_ms = time.ticks_ms()
    
    if alarm_armed:
        # If we just armed, beep immediately
        if not prev_state:
            # Play warning
            play_warning()
            # Update last alarm timestamp
            last_alarm_ms = now_ms
        else:
            # While armed, beep again every cooldown interval
            if time.ticks_diff(now_ms, last_alarm_ms) >= ALARM_COOLDOWN_S:
                # Play warning
                play_warning()
                # Update last alarm timestamp
                last_alarm_ms = now_ms
    else:
        # Disarmed: reset last_alarm to allow immediate warning sound
        last_alarm_ms = -10_000
            
    # Slow down the program
    time.sleep_ms(500)
```

## Full Example

<QuickLink 
  title="7.2_Speaker_Temperature_Warning.py"
  url="https://github.com/SolderedElectronics/PRIMJER" 
/>