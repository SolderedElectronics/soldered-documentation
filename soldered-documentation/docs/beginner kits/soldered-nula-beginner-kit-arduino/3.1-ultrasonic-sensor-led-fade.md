---
slug: /soldered-nula-beginner-kit-arduino/ultrasonic-sensor-led-fade
title: 3.1 Ultrasonic Sensor and LED Fade
id: nula-beginner-arduino-ultrasonic-sensor-led-fade
hide_title: False
---

<CenteredImage src="/img/under_construction.png" alt="placeholder" caption="Full example video" width="600px"/>

The goal of this example is to show you how to use an **ultrasonic distance sensor** to control the **brightness of an LED**.  
The closer an object is to the sensor, the brighter the LED becomes.  
This introduces the concept of **distance measurement** using time-of-flight and how to map those readings to a visual output.

<SuccessBox>

**In this documentation you will learn:**
- How to connect an **ultrasonic distance sensor (HC-SR04)** to the NULA board using standard wires.  
- How to use the **Soldered Ultrasonic Sensor library**.  
- How to measure distance in centimeters with `getDistance()`.  
- How to map those distance values to LED brightness with `map()` and `analogWrite()`.  
- How to print live readings to the Serial Monitor for debugging.

</SuccessBox>

**Hardware required:**
- 1× Soldered NULA MINI board  
- 1× HC-SR04 ultrasonic sensor  
- 1× LED (any color)  
- 1× 330Ω resistor  
- 1× Breadboard  
- Jumper wires  
- USB-C cable  


<CenteredImage src="/img/nula-beginner-kit-arduino/3_1components.jpg" caption="All components that are needed" />

---

## Putting the components together

### 1. Connect the LED
We will start by connecting the LED the same way as in [**1.1 LED Blinking**](/documentation/soldered-nula-beginner-kit-arduino/led-blinking).  

- Connect the **anode** (long leg) of the LED through a **330Ω resistor** to **IO02** on the NULA MINI board.  
- Connect the **cathode** (short leg) directly to **GND**.

<CenteredImage src="/img/nula-beginner-kit-arduino/connection3_1_1.jpg" caption="Step: 1." />

### 2. Connect the ultrasonic sensor

| **HC-SR04** Pin | **NULA MINI** Pin |
|------------------|------------------|
| VCC | 3.3V |
| GND | GND |
| TRIG | IO04 |
| ECHO | IO03 |

<InfoBox>
The **TRIG pin** sends a short pulse to trigger a measurement.  
The **ECHO pin** receives the reflected signal and measures how long it took for the sound to bounce back.
</InfoBox>

<CenteredImage src="/img/nula-beginner-kit-arduino/connection3_1_2.jpg" caption="Step: 2." />

---

## How does the ultrasonic sensor work?

The ultrasonic sensor measures distance by sending a short **ultrasonic pulse** (sound wave) and listening for its **echo**.  
It calculates the distance based on the time it takes for the sound to travel to an object and back.


`distance = (duration * speed of sound) / 2`


Since the sound travels both ways (out and back), we divide by 2.  
The Soldered Ultrasonic Sensor library handles all the timing internally and gives you a direct reading in **centimeters**.

---

## Setting up the pins

We define pin numbers for the trigger, echo, and LED.  
Inside **setup()**, we configure them as input or output and initialize Serial communication for debugging.

```cpp
const int trigPin = 4;
const int echoPin = 3;
const int ledPin  = 2;

long duration;
int distance;

void setup() {
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);
  pinMode(ledPin, OUTPUT);
  Serial.begin(115200);
}
```
---
## Understanding PWM and brightness control

The **NULA MINI** doesn't output true analog voltages, it uses **Pulse Width Modulation** (PWM). PWM rapidly turns the pin ON and OFF, and by adjusting how long it stays ON (the duty cycle), we can control how bright the LED appears.

| **Duty cycle** 	| **Visual effect** 	|
|---	|---	|
| 0% 	| LED completely OFF 	|
| 50% 	| LED at half brightness 	|
| 100% 	| LED fully ON 	|

<CenteredImage src="/img/nula-beginner-kit-arduino/pwm-explained.png" alt="PWM explained" caption="PWM visualization" />

The analogWrite(pin, value) function sets this duty cycle.
The higher the value, the brighter the LED.

<InfoBox> Some NULA pins support up to **12-bit PWM resolution (0–4095)**, but this example uses 8-bit range (**0–255**) for simplicity. </InfoBox>

---

## Reading distance and mapping to brightness

In **loop()** we read the distance value, constrain it to a useful range, and map it to the LED brightness.
The closer the object, the brighter the LED glows.

```cpp
void loop()
{
  // --- Measure distance from the sensor ---
  float distance = hc.getDistance();   // Distance in centimeters
  long duration  = hc.getDuration();   // Echo round-trip time (for info)

  // --- Print distance readings ---
  Serial.print("Distance from obstacle: ");
  Serial.print(distance);
  Serial.println(" cm");

  // --- Clamp distance within a valid range ---
  if (distance < 2) distance = 2;
  if (distance > 50) distance = 50;

  // --- Map distance to LED brightness ---
  int brightness = map(distance, 50, 2, 0, 255);  // Closer = brighter
  brightness = constrain(brightness, 0, 255);

  // --- Apply brightness to LED ---
  analogWrite(LEDPIN, brightness);

  // --- Print brightness info ---
  Serial.print("LED Brightness Level: ");
  Serial.println(brightness);

  delay(150);  // Small delay for readability
}

```

<CenteredImage src="/img/nula-beginner-kit-arduino/3_1serial_output.png" caption="Serial Monitor output" width="400px" />

---

## Full example
<CenteredImage src="/img/under_construction.png" alt="placeholder" caption="Full example video" width="600px"/>

Check out the full example code on the link below:
<QuickLink title="3.1_Ultrasonic_Sensor_and_LED_Fade.ino" description="Example that shows how to measure distance with an ultrasonic sensor and use it to control LED brightness." url="https://github.com/SolderedElectronics/Soldered-NULA-Beginner-kit-Arduino-project-examples/blob/main/3_Sensors_and_outputs/3.1_Ultrasonic_Sesnor_and_LED_Fade/3.1_Ultrasonic_Sesnor_and_LED_Fade.ino" />